{"version":3,"file":null,"sources":["src/lib/gl.js","src/lib/util.js","src/main.js"],"sourcesContent":["\nconst canvas = document.createElement('canvas')\ndocument.body.appendChild(canvas)\n\nconst ratio = window.devicePixelRatio || 1\ncanvas.width = window.innerWidth * ratio\ncanvas.height = window.innerHeight * ratio\ncanvas.style.width = '100%'\n\nexport const gl = canvas.getContext(\"webgl\") ||\n         canvas.getContext(\"experimental-webgl\")\n\n// shader compiler\nexport const compile = function(gl, type, source) {\n\n  var shader = gl.createShader(type)\n  gl.shaderSource(shader, source)\n  gl.compileShader(shader)\n\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS))\n    throw new Error(gl.getShaderInfoLog(shader))\n\n  return shader\n}\n\n\n\nexport const createProgram = function(vertex, fragment) {\n\n  var vertexShader = compile(gl, gl.VERTEX_SHADER, vertex)\n  var fragmentShader = compile(gl, gl.FRAGMENT_SHADER, fragment)\n\n  var program = gl.createProgram()\n  gl.attachShader(program, vertexShader)\n  gl.attachShader(program, fragmentShader)\n  gl.linkProgram(program)\n\n  if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n    throw new Error(gl.getProgramInfoLog(program))\n  }\n\n  gl.useProgram(program)\n\n  return program\n}\n\n\n\nexport const interleave = function(array, size, callback) {\n  const chunk = array.slice(0,size)\n  for (var i = 0; i < array.length; i += size) {\n    callback(chunk, i / size)\n    array.set(chunk, i)\n  }\n\n}\n\n\nexport const sendAttibutes = function(program, array, attrs, indices) {\n\n  const length = attrs.reduce(function(memo, item) {\n    return memo + item[1]\n  }, 0)\n\n  var buffer = gl.createBuffer()\n  if (!buffer) throw new Error('Failed to create buffer.')\n  gl.bindBuffer(gl.ARRAY_BUFFER, buffer)\n  gl.bufferData(gl.ARRAY_BUFFER, array, gl.STATIC_DRAW)\n\n  attrs.reduce(function(memo, item) {\n\n    var location = gl.getAttribLocation(program, item[0])\n\n    gl.vertexAttribPointer(\n      location,\n      item[1],\n      gl.FLOAT,\n      gl.FALSE,\n      Float32Array.BYTES_PER_ELEMENT * length,\n      Float32Array.BYTES_PER_ELEMENT * memo)\n    gl.enableVertexAttribArray(location)\n\n\n    return memo + item[1]\n  }, 0)\n\n  if(indices) {\n    var iBuffer = gl.createBuffer()\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, iBuffer)\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.STATIC_DRAW)\n  }\n\n}\n","\nexport const scale = (a, b) => (n) => n * (b - a) + a\n\nexport const random = (a, b) => scale(a,b)(Math.random())\n","import { gl, createProgram, interleave, sendAttibutes } from './lib/gl.js'\nimport { random } from './lib/util.js'\n\nimport vertex from './vert.glsl'\nimport fragment from './frag.glsl'\n\nconst program = createProgram(vertex, fragment)\n\nconst rows = 50\nconst cols = 50\nconst n = rows * cols\n\nconst data = new Float32Array(n * 7)\n\ninterleave(data, 7, (chunk, i) => {\n  const x = i % cols\n  const y = (i / cols) | 0\n\n  chunk[0] = ((x/cols) - .5) * 1.5\n  chunk[1] = ((y/rows) - .5) * 1.5\n\n  // movement offset/phase\n  chunk[2] = random(0, Math.PI*2)\n  chunk[3] = random(0, Math.PI*2)\n\n  // color\n  chunk[4] = random(0.5, 1)\n  chunk[5] = random(0.5, 1)\n  chunk[6] = random(0.5, 1)\n\n})\n\n\nconst indices = []\n\nfor (let x = 0; x < cols - 1; x++) {\n  for (let y = 0; y < rows - 1; y++) {\n\n    indices.push(\n      x +     y * cols,\n      x + 1 + y * cols\n    )\n\n    indices.push(\n      x +     y * cols,\n      x + 1 + (y+1) * cols\n    )\n\n  }\n}\n\nsendAttibutes(\n  program, data,\n  [\n    ['aPosition', 2],\n    ['aPhase', 2],\n    ['aColor', 3]\n  ],\n  indices\n)\n\n\nconst uTime = gl.getUniformLocation(program, 'uTime')\n\nfunction render(t) {\n  requestAnimationFrame(render)\n\n  gl.uniform1f(uTime, t / 10000)\n  gl.drawElements(gl.LINES, indices.length, gl.UNSIGNED_SHORT, 0)\n}\n\nrequestAnimationFrame(render)\n"],"names":["const","let"],"mappings":"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"}